<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<RuleBase>
    <Rule>
        <Action>
            <action_type>update</action_type>
        </Action>
        <Event>
            <conditions>
                <condition>
                    <attribute>remaining_seats</attribute>
                    <operator>&lt;=</operator>
                    <value>5</value>
                </condition>
            </conditions>
            <event_type>select</event_type>
        </Event>
        <ruleId>1</ruleId>
        <rule_description>Adding extra compartments (seats) on demand</rule_description>
        <rule_status>Active</rule_status>
        <rule_type>defered</rule_type>
        <table>train</table>
    </Rule>
    <Rule>
        <Action>
            <action_type>method</action_type>
            <method_path>sendmail pwdchange</method_path>
        </Action>
        <Event>
            <conditions>
                <condition>
                    <attribute>CURRENT_DATE-date(pswd_last_changed)</attribute>
                    <operator>=</operator>
                    <value>30</value>
                </condition>
            </conditions>
            <event_type>select</event_type>
        </Event>
        <ruleId>27706</ruleId>
        <rule_description>send mail</rule_description>
        <rule_status>Active</rule_status>
        <rule_type>defered</rule_type>
        <table>user</table>
    </Rule>
    <Rule>
        <Action>
            <action_type>update</action_type>
            <method_path>none</method_path>
        </Action>
        <Event>
            <conditions>
                <condition>
                    <attribute>remaining_seats</attribute>
                    <operator>&lt;=</operator>
                    <value>5</value>
                </condition>
                <conjunction>none</conjunction>
            </conditions>
            <event_type>select</event_type>
        </Event>
        <ruleId>0</ruleId>
        <rule_description>Adding extra compartments (seats) on demand</rule_description>
        <rule_status>Active</rule_status>
        <rule_type>deferred</rule_type>
        <table>train</table>
    </Rule>
    <Rule>
        <Action>
            <action_type>update</action_type>
            <method_path>none</method_path>
            <queries>
                <query>update train set remaining_seats=remaining_seats+10 where train_id=?</query>
            </queries>
            <queries>
                <query>update train set remaining_seats=remaining_seats-10 where train_id=?</query>
            </queries>
        </Action>
        <Event>
            <conditions>
                <condition>
                    <attribute>remaining_seats</attribute>
                    <operator>&lt;=</operator>
                    <value>5</value>
                </condition>
                <conjunction>none</conjunction>
            </conditions>
            <event_type>select</event_type>
        </Event>
        <ruleId>0</ruleId>
        <rule_description>Adding extra compartments (seats) on demand</rule_description>
        <rule_status>Active</rule_status>
        <rule_type>deferred</rule_type>
        <table>train</table>
    </Rule>
</RuleBase>
